<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YzemanBot - Earn Rewards</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src='//libtl.com/sdk.js' data-zone='9683863' data-sdk='show_9683863'></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6a11cb;
            --secondary: #2575fc;
            --success: #00c853;
            --warning: #ffab00;
            --danger: #ff5252;
            --dark: #1a1b25;
            --darker: #12131a;
            --light: #f8f9fa;
            --gray: #6c757d;
            --card-bg: #252836;
            --card-border: #2d3343;
            --fresher: #4CAF50;
            --brute: #2196F3;
            --silver: #9E9E9E;
            --gold: #FFD700;
            --platinum: #E0E0E0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--darker), var(--dark));
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 20px 0 30px;
            position: relative;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }

        .user-info {
            text-align: left;
            flex: 1;
        }

        .user-name {
            font-weight: 600;
            margin-bottom: 3px;
        }

        .user-id {
            font-size: 12px;
            color: var(--gray);
        }

        .logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 36px;
            box-shadow: 0 8px 20px rgba(106, 17, 203, 0.3);
        }

        h1 {
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(to right, #ff9a9e, #fad0c4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .subtitle {
            color: var(--gray);
            font-size: 16px;
        }

        .tabs {
            display: flex;
            background: var(--card-bg);
            border-radius: 16px;
            overflow: hidden;
            margin-bottom: 25px;
            border: 1px solid var(--card-border);
        }

        .tab {
            flex: 1;
            padding: 16px 10px;
            text-align: center;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            border-bottom: 3px solid var(--secondary);
            background: rgba(37, 117, 252, 0.1);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tab-content.active {
            display: block;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 18px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            margin: 8px 0;
            color: var(--light);
        }

        .stat-label {
            font-size: 14px;
            color: var(--gray);
        }

        .progress-container {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .progress-title {
            font-weight: 600;
            font-size: 18px;
        }

        .progress-amount {
            color: var(--success);
            font-weight: 700;
        }

        .progress-bar-bg {
            height: 12px;
            background: #2d3343;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 10px;
            width: 0%;
            transition: width 1s ease;
        }

        .progress-goal {
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            color: var(--gray);
        }

        .task-list {
            margin-bottom: 25px;
        }

        .task-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .task-card:hover {
            transform: translateY(-3px);
        }

        .task-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(45deg, #ff9a9e, #fad0c4);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 20px;
        }

        .task-details {
            flex: 1;
        }

        .task-title {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 16px;
        }

        .task-description {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 8px;
        }

        .task-reward {
            color: var(--success);
            font-weight: 600;
            font-size: 14px;
        }

        .task-action {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 12px;
            padding: 10px 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .task-action:disabled {
            background: var(--gray);
            cursor: not-allowed;
        }

        .tier-card {
            background: linear-gradient(135deg, #3a1c71, #d76d77, #ffaf7b);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 25px;
            position: relative;
            overflow: hidden;
        }

        .tier-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1;
        }

        .tier-content {
            position: relative;
            z-index: 2;
            text-align: center;
        }

        .tier-title {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 10px;
            color: white;
        }

        .tier-name {
            font-size: 32px;
            font-weight: 900;
            background: linear-gradient(to right, #f8ff00, #3ad59f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .tier-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .tier-stat {
            text-align: center;
        }

        .tier-stat-value {
            font-size: 24px;
            font-weight: 700;
            color: white;
        }

        .tier-stat-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }

        .ad-container {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            margin-bottom: 25px;
        }

        .ad-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .ad-description {
            color: var(--gray);
            margin-bottom: 20px;
        }

        .ad-placeholder {
            height: 180px;
            background: linear-gradient(45deg, #1a2a6c, #b21f1f, #1a2a6c);
            border-radius: 12px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: rgba(255, 255, 255, 0.7);
        }

        .ad-action {
            background: linear-gradient(45deg, #ff512f, #f09819);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 30px;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ad-action:hover {
            transform: scale(1.05);
        }

        .referral-section {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .referral-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--light);
            text-align: center;
        }

        .referral-code {
            font-family: monospace;
            font-size: 18px;
            letter-spacing: 2px;
            padding: 12px;
            background: rgba(37, 117, 252, 0.15);
            border: 1px dashed var(--secondary);
            border-radius: 12px;
            text-align: center;
            margin: 15px 0;
        }

        .copy-btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 20px auto;
            width: 100%;
            max-width: 200px;
        }

        .social-proof {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
        }

        .social-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .social-icons {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 28px;
        }

        .social-icons a {
            color: var(--light);
            transition: all 0.3s ease;
        }

        .social-icons a:hover {
            color: var(--secondary);
            transform: translateY(-3px);
        }

        .withdraw-container {
            text-align: center;
            padding: 20px;
        }

        .withdraw-info {
            margin-bottom: 20px;
            font-size: 16px;
            color: var(--gray);
        }

        .withdraw-btn {
            background: linear-gradient(45deg, #00c853, #64dd17);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 15px 40px;
            font-weight: 700;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .withdraw-btn:disabled {
            background: var(--gray);
            cursor: not-allowed;
            transform: none;
        }

        .withdraw-btn:disabled:hover {
            transform: none;
        }

        .withdraw-btn:hover {
            transform: scale(1.05);
        }

        .tier-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        .fresher { background: var(--fresher); }
        .brute { background: var(--brute); }
        .silver { background: var(--silver); color: #000; }
        .gold { background: var(--gold); color: #000; }
        .platinum { background: var(--platinum); color: #000; }

        .timer {
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin: 15px 0;
            color: var(--success);
            display: none;
        }

        .wallet-input {
            width: 100%;
            padding: 15px;
            border-radius: 12px;
            border: none;
            background: var(--darker);
            color: var(--light);
            font-size: 16px;
            margin: 15px 0;
        }

        .submit-btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 12px;
            padding: 15px;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--success);
            color: white;
            padding: 15px 30px;
            border-radius: 12px;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: none;
        }

        .iframe-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--darker);
            z-index: 1000;
            display: none;
            flex-direction: column;
        }

        .iframe-header {
            padding: 15px;
            background: var(--card-bg);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .iframe-content {
            flex: 1;
            border: none;
        }

        .close-iframe {
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 15px;
            cursor: pointer;
        }
        
        .daily-reset {
            text-align: center;
            font-size: 14px;
            color: var(--gray);
            margin: 10px 0;
        }
        
        .ad-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }
        
        .ad-counter {
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
        }
        
        .premium-ad-card {
            background: linear-gradient(45deg, #8e2de2, #4a00e0);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .premium-ad-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .premium-ad-icon {
            font-size: 32px;
            color: var(--gold);
        }
        
        .premium-ad-details {
            flex: 1;
        }
        
        .premium-ad-title {
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .premium-ad-description {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 10px;
        }
        
        .premium-ad-reward {
            color: var(--gold);
            font-weight: 700;
        }
        
        .premium-ad-action {
            background: linear-gradient(45deg, #ff9a9e, #fad0c4);
            color: black;
            border: none;
            border-radius: 12px;
            padding: 10px 20px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .channel-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .channel-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, #ff512f, #f09819);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .channel-info {
            flex: 1;
        }

        .channel-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .channel-description {
            font-size: 14px;
            color: var(--gray);
        }

        .channel-join {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 12px;
            padding: 8px 15px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .admin-message {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            border: 1px solid var(--secondary);
        }
        
        .admin-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--light);
        }
        
        .admin-info {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 10px;
        }
        
        .admin-contact {
            color: var(--secondary);
            font-weight: 600;
        }
        
        .conversion-info {
            text-align: center;
            font-size: 14px;
            color: var(--gray);
            margin: 10px 0;
        }
        
        /* Bonus section styles */
        .bonus-section {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .bonus-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--light);
            text-align: center;
        }
        
        .bonus-input-container {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .bonus-input {
            flex: 1;
            padding: 12px;
            background: var(--darker);
            border: none;
            border-radius: 12px;
            color: var(--light);
            font-size: 16px;
        }
        
        .bonus-btn {
            background: linear-gradient(45deg, #FF9800, #FF5722);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 20px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .bonus-list {
            margin-top: 20px;
        }
        
        .bonus-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--card-border);
        }
        
        .bonus-code {
            font-family: monospace;
            font-weight: 600;
        }
        
        .bonus-reward {
            color: var(--success);
        }
        
        .redeemed-badge {
            background: var(--success);
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
        }
        
        /* New styles for referral link container */
        .referral-link-container {
            margin-top: 20px;
            text-align: center;
        }
        
        .referral-link-box {
            background: rgba(37, 117, 252, 0.1);
            border: 1px solid var(--secondary);
            border-radius: 12px;
            padding: 12px;
            margin: 15px 0;
            word-break: break-all;
        }
        /* Add pointer events fix */
        button, .tab, .task-action, .channel-join, .copy-btn, .withdraw-btn, .submit-btn, .bonus-btn, .premium-ad-action, .ad-action {
            cursor: pointer;
            pointer-events: auto !important;
        }

        /* Disabled state */
        button:disabled, .task-action:disabled {
            pointer-events: none;
        }
        
        /* Fix for iframe blocking */
        .iframe-container {
            z-index: 10000;
        }
        
        /* Loading spinner */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 4px solid #3498db;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .ad-loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: white;
            font-size: 18px;
            text-align: center;
        }
        /* Add new styles for withdrawal history */
        .withdrawal-history {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 20px;
            margin-top: 25px;
            max-height: 300px;
            overflow-y: auto;
        }

        .history-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 15px;
            text-align: center;
            color: var(--light);
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--card-border);
        }

        .history-amount {
            font-weight: 600;
            color: var(--success);
        }

        .history-date {
            color: var(--gray);
            font-size: 14px;
        }

        .history-status {
            font-size: 12px;
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: 600;
        }

        .status-pending {
            background: var(--warning);
            color: #000;
        }

        .status-completed {
            background: var(--success);
            color: white;
        }
    </style>
</head>
<body>
    <div class="notification" id="notification">Reward claimed successfully!</div>
    
    <div class="ad-loading" id="adLoading">
        <div class="spinner"></div>
        <div class="ad-status" id="adStatus">Loading ad...</div>
    </div>

    <div class="iframe-container" id="iframeContainer">
        <div class="iframe-header">
            <div>Task in Progress</div>
            <button class="close-iframe" id="closeIframe">Close</button>
        </div>
        <iframe class="iframe-content" id="taskIframe" allow="autoplay"></iframe>
        <div class="timer" id="timer">05:00</div>
    </div>

    <div class="container">
        <header>
            <div class="user-profile">
                <img id="userAvatar" class="user-avatar" src="" alt="Profile">
                <div class="user-info">
                    <div class="user-name" id="userName">Loading...</div>
                    <div class="user-id" id="userId">ID: loading</div>
                </div>
            </div>
            
            <div class="logo">
                <i class="fas fa-coins"></i>
            </div>
            <h1>YzemanBot</h1>
            <p class="subtitle">Earn Rewards with Free Server Integration</p>
        </header>

        <!-- Updated Tabs with Bonus Codes tab -->
        <div class="tabs">
            <div class="tab active" data-tab="earn">Earn Points</div>
            <div class="tab" data-tab="refer">Refer Friends</div>
            <div class="tab" data-tab="social">Social Rewards</div>
            <div class="tab" data-tab="bonus">Bonus Codes</div>
            <div class="tab" data-tab="withdraw">With<br>draw</div>
        </div>

        <!-- Earn Points Tab -->
        <div class="tab-content active" id="earnTab">
            <div class="daily-reset" style="background: linear-gradient(135deg, var(--darker), var(--dark));">
                <i class="fas fa-sync-alt"></i> Daily tasks reset in <span id="resetTimer"></span>
            </div>
            
            <div class="conversion-info">
                <i class="fas fa-info-circle"></i> 100,000 points = $1 USD
            </div>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-label">Your Points</div>
                    <div class="stat-value" id="points">0 pts</div>
                    <div>$<span id="pointsUSD">0.00</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Your Tier</div>
                    <div class="stat-value" id="userTier">Fresher</div>
                    <div id="referralCount">0 referrals</div>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-header">
                    <div class="progress-title">Withdrawal Progress</div>
                    <div class="progress-amount">$<span id="progressAmount">0.00</span>/$1000</div>
                </div>
                <div class="progress-bar-bg">
                    <div class="progress-bar-fill" id="progressBar"></div>
                </div>
                <div class="progress-goal">Reach $1000 to withdraw your earnings</div>
            </div>

            <div class="tier-card">
                <div class="tier-content">
                    <div class="tier-title">Current Tier</div>
                    <div class="tier-name" id="currentTier">Fresher</div>
                    <div class="tier-stats">
                        <div class="tier-stat">
                            <div class="tier-stat-value" id="tierMultiplier">1x</div>
                            <div class="tier-stat-label">Earning Rate</div>
                        </div>
                        <div class="tier-stat">
                            <div class="tier-stat-value" id="nextTierRef">50</div>
                            <div class="tier-stat-label">Refs to Next Tier</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="task-list">
                <div class="task-card">
                    <div class="task-icon">
                        <i class="fas fa-ad"></i>
                    </div>
                    <div class="task-details">
                        <div class="task-title">Visit an Ad <span class="tier-badge fresher">+51 pts</span></div>
                        <div class="task-description">Watch a 1-minute ad to earn points</div>
                        <div class="task-reward">Daily limit: <span id="adCounter">0/∞</span></div>
                    </div>
                    <button class="task-action" id="watchAdBtn">Watch</button>
                </div>

                <div class="task-card">
                    <div class="task-icon">
                        <i class="fab fa-youtube"></i>
                    </div>
                    <div class="task-details">
                        <div class="task-title">Watch YouTube Video</div>
                        <div class="task-description">Watch for 5 minutes to earn points</div>
                        <div class="task-reward">+2000 points</div>
                    </div>
                    <button class="task-action" id="watchYoutubeBtn">Watch</button>
                </div>

                <div class="task-card">
                    <div class="task-icon">
                        <i class="fas fa-globe"></i>
                    </div>
                    <div class="task-details">
                        <div class="task-title">Visit Website</div>
                        <div class="task-description">Stay 2 minute to earn points</div>
                        <div class="task-reward">+500 points</div>
                    </div>
                    <button class="task-action" id="visitWebsiteBtn">Visit</button>
                </div>

                <div class="task-card">
                    <div class="task-icon">
                        <i class="fas fa-user-friends"></i>
                    </div>
                    <div class="task-details">
                        <div class="task-title">Refer a Friend</div>
                        <div class="task-description">Get points when friends join</div>
                        <div class="task-reward">+<span id="referralReward">1000</span> points</div>
                    </div>
                    <button class="task-action" id="referBtn">Refer</button>
                </div>
            </div>

            <div class="ad-container">
                <h2 class="ad-title">Premium Ad Center</h2>
                <p class="ad-description">Watch high-value ads for more points</p>
                
                <div class="premium-ad-card">
                    <div class="premium-ad-content">
                        <div class="premium-ad-icon">
                            <i class="fab fa-youtube"></i>
                        </div>
                        <div class="premium-ad-details">
                            <div class="premium-ad-title">Premium Video Task</div>
                            <div class="premium-ad-description">Watch YouTube video for 20 minutes, like and comment to earn</div>
                            <div class="premium-ad-reward">+1000 points</div>
                        </div>
                        <button class="premium-ad-action" id="premiumAdBtn">Start</button>
                    </div>
                </div>
                
                <div class="ad-controls">
                    <div class="ad-counter">Today: <span id="premiumAdCounter">0/1</span></div>
                    <button class="ad-action" id="changeAdBtn">Change Video</button>
                </div>
            </div>
        </div>

        <!-- Simplified Refer Friends Tab -->
        <div class="tab-content" id="referTab">
            <div class="referral-section">
                <h2 class="referral-title">Refer Friends & Earn</h2>
                <p>Share your referral link with friends and earn points for each friend who signs up</p>
                
                <div class="referral-code" id="referralCode">YZEMAN-<span id="userCode">X7B9F2</span></div>
                
                <div class="referral-link-container">
                    <p>Your referral link:</p>
                    <div class="referral-link-box" id="referralLink">https://t.me/YzemanBot?start=ref-X7B9F2</div>
                </div>
                
                <button class="copy-btn" id="copyCodeBtn">
                    <i class="fas fa-copy"></i> Copy Referral Link
                </button>
            </div>

            <div class="task-list">
                <div class="task-card">
                    <div class="task-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="task-details">
                        <div class="task-title">Your Referral Progress</div>
                        <div class="task-description">Earn higher tiers with more referrals</div>
                        <div class="task-reward">Current referrals: <span id="currentRefCount">0</span></div>
                        <div class="task-reward">Current reward per referral: <span id="currentReferralReward">1000</span> pts</div>
                    </div>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-header">
                    <div class="progress-title">Tier Progress</div>
                    <div class="progress-amount"><span id="currentRefs">0</span>/<span id="nextTierReq">50</span></div>
                </div>
                <div class="progress-bar-bg">
                    <div class="progress-bar-fill" id="tierProgressBar"></div>
                </div>
                <div class="progress-goal">Reach next tier for better rewards</div>
            </div>
            
            <div class="tier-info">
                <h3>Tier Benefits</h3>
                <ul>
                    <li><strong>Fresher:</strong> 1x earning rate, 1000 points per referral</li>
                    <li><strong>Brute (50 referrals):</strong> 1.2x earning rate, 1500 points per referral</li>
                    <li><strong>Silver (150 referrals):</strong> 1.5x earning rate, 2000 points per referral</li>
                    <li><strong>Gold (300 referrals):</strong> 2x earning rate, 3000 points per referral</li>
                    <li><strong>Platinum (500 referrals):</strong> 3x earning rate, 5000 points per referral</li>
                </ul>
            </div>
        </div>

        <!-- Social Rewards Tab -->
        <div class="tab-content" id="socialTab">
            <div class="channel-card">
                <div class="channel-icon">
                    <i class="fab fa-telegram"></i>
                </div>
                <div class="channel-info">
                    <div class="channel-name">Official Telegram Channel</div>
                    <div class="channel-description">Join for updates and bonus rewards</div>
                </div>
                <button class="channel-join" id="joinChannelBtn">Join</button>
            </div>

            <div class="task-list">
                <div class="task-card">
                    <div class="task-icon">
                        <i class="fab fa-youtube"></i>
                    </div>
                    <div class="task-details">
                        <div class="task-title">Subscribe to YouTube Channel 1</div>
                        <div class="task-description">Subscribe to Yzeman Updates</div>
                        <div class="task-reward">+$50 bonus</div>
                    </div>
                    <button class="task-action" id="youtubeBtn1">Subscribe</button>
                </div>

                <div class="task-card">
                    <div class="task-icon">
                        <i class="fab fa-youtube"></i>
                    </div>
                    <div class="task-details">
                        <div class="task-title">Subscribe to YouTube Channel 2</div>
                        <div class="task-description">Subscribe to Coding App with HTML</div>
                        <div class="task-reward">+$50 bonus</div>
                    </div>
                    <button class="task-action" id="youtubeBtn2">Subscribe</button>
                </div>

                <div class="task-card">
                    <div class="task-icon">
                        <i class="fab fa-youtube"></i>
                    </div>
                    <div class="task-details">
                        <div class="task-title">Subscribe to YouTube Channel 3</div>
                        <div class="task-description">Subscribe to Yzeman Hacker</div>
                        <div class="task-reward">+$50 bonus</div>
                    </div>
                    <button class="task-action" id="youtubeBtn3">Subscribe</button>
                </div>

                <div class="task-card">
                    <div class="task-icon">
                        <i class="fab fa-facebook"></i>
                    </div>
                    <div class="task-details">
                        <div class="task-title">Follow on Facebook</div>
                        <div class="task-description">Follow our Facebook page</div>
                        <div class="task-reward">+$50 bonus</div>
                    </div>
                    <button class="task-action" id="facebookBtn">Follow</button>
                </div>

                <div class="task-card">
                    <div class="task-icon">
                        <i class="fab fa-instagram"></i>
                    </div>
                    <div class="task-details">
                        <div class="task-title">Follow on Instagram</div>
                        <div class="task-description">Follow our Instagram account</div>
                        <div class="task-reward">+$50 bonus</div>
                    </div>
                    <button class="task-action" id="instagramBtn">Follow</button>
                </div>
                
                <div class="task-card">
                    <div class="task-icon">
                        <i class="fab fa-twitter"></i>
                    </div>
                    <div class="task-details">
                        <div class="task-title">Follow on Twitter</div>
                        <div class="task-description">Follow our Twitter account</div>
                        <div class="task-reward">+$50 bonus</div>
                    </div>
                    <button class="task-action" id="twitterBtn">Follow</button>
                </div>
            </div>
        </div>

        <!-- Bonus Codes Tab -->
        <div class="tab-content" id="bonusTab">
            <div class="bonus-section">
                <h2 class="bonus-title">Redeem Bonus Codes</h2>
                <p>Enter bonus codes to earn extra points and dollars</p>
                
                <div class="bonus-input-container">
                    <input type="text" class="bonus-input" id="bonusCodeInput" placeholder="Enter bonus code">
                    <button class="bonus-btn" id="redeemBonusBtn">Redeem</button>
                </div>
                
                <div class="bonus-list">
                    
                </div>
            </div>
            
            <div class="social-proof">
                <div class="social-title">Join Our Telegram Channel for More Bonus Codes</div>
                <div class="social-icons">
                    <a href="https://t.me/YzemanEarnBotChannel" target="_blank"><i class="fab fa-telegram"></i></a>
                </div>
            </div>
        </div>

        <!-- Withdraw Tab -->
    <div class="tab-content" id="withdrawTab">
        <div class="progress-container">
            <div class="progress-header">
                <div class="progress-title">Withdrawal Progress</div>
                <div class="progress-amount">$<span id="withdrawProgress">0.00</span>/$1000</div>
            </div>
            <div class="progress-bar-bg">
                <div class="progress-bar-fill" id="withdrawBar" style="width: 0%"></div>
            </div>
            <div class="progress-goal">Reach $1000 to withdraw your earnings</div>
        </div>

        <div class="withdraw-container">
            <div class="withdraw-info">
                <p>Minimum withdrawal: $1000 (100,000,000 points)</p>
                <p>Withdrawals are processed via USDT (TRC-20)</p>
                <p>Admin will contact you after withdrawal request</p>
            </div>
            
            <input type="text" class="wallet-input" id="walletAddress" placeholder="Enter USDT (TRC-20) Wallet Address">
            <button class="submit-btn" id="submitWalletBtn">Submit Wallet Address</button>
            
            <button class="withdraw-btn" id="withdrawBtn" disabled>Withdraw $1000</button>
        </div>
        
        <div class="admin-message">
            <div class="admin-title">After Withdrawal</div>
            <div class="admin-info">Admin will contact you via Telegram to complete the withdrawal process</div>
            <div class="admin-contact">@yzemanreal</div>
        </div>
        
        <!-- Add withdrawal history section -->
        <div class="withdrawal-history">
            <div class="history-title">Withdrawal History</div>
            <div id="withdrawalHistoryList">
                <!-- History items will be added here dynamically -->
            </div>
        </div>
    </div>

    <script>
// Initialize Telegram Web App
const tg = window.Telegram?.WebApp;

// DOM Elements
const pointsElement = document.getElementById('points');
const pointsUSDElement = document.getElementById('pointsUSD');
const progressBar = document.getElementById('progressBar');
const progressAmount = document.getElementById('progressAmount');
const userTierElement = document.getElementById('userTier');
const referralCountElement = document.getElementById('referralCount');
const currentTierElement = document.getElementById('currentTier');
const tierMultiplierElement = document.getElementById('tierMultiplier');
const nextTierRefElement = document.getElementById('nextTierRef');
const referralCodeElement = document.getElementById('userCode');
const referralLinkElement = document.getElementById('referralLink');
const withdrawBtn = document.getElementById('withdrawBtn');
const withdrawProgress = document.getElementById('withdrawProgress');
const withdrawBar = document.getElementById('withdrawBar');
const notification = document.getElementById('notification');
const iframeContainer = document.getElementById('iframeContainer');
const taskIframe = document.getElementById('taskIframe');
const closeIframe = document.getElementById('closeIframe');
const timerElement = document.getElementById('timer');
const walletAddressInput = document.getElementById('walletAddress');
const submitWalletBtn = document.getElementById('submitWalletBtn');
const resetTimerElement = document.getElementById('resetTimer');
const adCounterElement = document.getElementById('adCounter');
const premiumAdCounterElement = document.getElementById('premiumAdCounter');
const referralRewardElement = document.getElementById('referralReward');
const adLoading = document.getElementById('adLoading');
const adStatus = document.getElementById('adStatus');
const userNameElement = document.getElementById('userName');
const userIdElement = document.getElementById('userId');
const userAvatarElement = document.getElementById('userAvatar');
const joinChannelBtn = document.getElementById('joinChannelBtn');
const currentRefsElement = document.getElementById('currentRefs');
const nextTierReqElement = document.getElementById('nextTierReq');
const currentRefCountElement = document.getElementById('currentRefCount');
const currentReferralRewardElement = document.getElementById('currentReferralReward');
const redeemBonusBtn = document.getElementById('redeemBonusBtn');
const bonusCodeInput = document.getElementById('bonusCodeInput');

// User data
let userData = {
    id: '',
    points: 0,
    referrals: 0,
    tier: "Fresher",
    multiplier: 1,
    nextTierRefs: 50,
    referralCode: '',
    completedSocial: {
        youtube1: false,
        youtube2: false,
        youtube3: false,
        facebook: false,
        instagram: false,
        twitter: false,
        telegram: false
    },
    completedTasks: {
        website: 0,
        youtubeWatch: 0,
        adWatch: 0,
        premiumAd: 0
    },
    socialDollars: 0,
    walletAddress: "",
    adCount: 0,
    premiumAdCount: 0,
    dailyReset: new Date().setHours(24, 0, 0, 0),
    usedBonusCodes: {},
    withdrawals: []
};

// Tier system with higher requirements
const tiers = [
    { name: "Fresher", refsRequired: 0, multiplier: 1, adReward: 51, referralReward: 1000 },
    { name: "Brute", refsRequired: 50, multiplier: 1.2, adReward: 74, referralReward: 1500 },
    { name: "Silver", refsRequired: 150, multiplier: 1.5, adReward: 105, referralReward: 2000 },
    { name: "Gold", refsRequired: 300, multiplier: 2, adReward: 140, referralReward: 3000 },
    { name: "Platinum", refsRequired: 500, multiplier: 3, adReward: 210, referralReward: 5000 }
];

// Initialize app
function initApp() {
    if (tg) {
        tg.expand();
        tg.enableClosingConfirmation();
        
        // Set up user profile
        const user = tg.initDataUnsafe.user;
        if (user) {
            userData.id = user.id.toString();
            userNameElement.textContent = `${user.first_name} ${user.last_name || ''}`.trim();
            userIdElement.textContent = `ID: ${user.id}`;
            
            if (user.photo_url) {
                userAvatarElement.src = user.photo_url;
            } else {
                userAvatarElement.src = 'https://via.placeholder.com/50';
            }
        } else {
            userData.id = Date.now().toString();
            userNameElement.textContent = 'Telegram User';
            userIdElement.textContent = `ID: ${userData.id}`;
            userAvatarElement.src = 'https://via.placeholder.com/50';
        }
    } else {
        userData.id = Date.now().toString();
        userNameElement.textContent = 'Test User';
        userIdElement.textContent = `ID: ${userData.id}`;
        userAvatarElement.src = 'https://via.placeholder.com/50';
    }
    
    loadLocalData();
    handleReferral();
    setupEventListeners();
    startResetTimer();
}

function handleReferral() {
    let refCode = '';
    
    if (window.Telegram && Telegram.WebApp) {
        const startParam = Telegram.WebApp.startParam;
        if (startParam && startParam.startsWith('ref-')) {
            refCode = startParam.split('ref-')[1];
        }
    }
    
    if (!refCode) {
        const urlParams = new URLSearchParams(window.location.search);
        refCode = urlParams.get('ref');
    }
    
    if (refCode) {
        localStorage.setItem('referralCode', refCode);
        showNotification('Referral code applied!');
        processReferral(refCode);
    }
}

function processReferral(refCode) {
    const userCode = generateUserReferralCode();
    if (refCode && refCode !== userCode) {
        const allUsers = JSON.parse(localStorage.getItem('allUsers') || '{}');
        const referrerId = Object.keys(allUsers).find(id => 
            allUsers[id].referralCode === refCode
        );
        
        if (referrerId) {
            const referrer = allUsers[referrerId];
            const currentTier = tiers.find(t => t.name === referrer.tier);
            const reward = currentTier?.referralReward || 1000;
            
            referrer.referrals += 1;
            referrer.points += reward;
            
            const tierIndex = tiers.findIndex(t => t.name === referrer.tier);
            if (tierIndex < tiers.length - 1 && referrer.referrals >= tiers[tierIndex + 1].refsRequired) {
                referrer.tier = tiers[tierIndex + 1].name;
                referrer.multiplier = tiers[tierIndex + 1].multiplier;
            }
            
            allUsers[referrerId] = referrer;
            localStorage.setItem('allUsers', JSON.stringify(allUsers));
            
            userData.points += 500;
            saveUserData();
            showNotification('Referral applied! +500 bonus points');
        }
    }
    
    localStorage.removeItem('referralCode');
}

function generateUserReferralCode() {
    let userCode = localStorage.getItem('userReferralCode');
    if (!userCode) {
        userCode = generateReferralCode();
        localStorage.setItem('userReferralCode', userCode);
        userData.referralCode = userCode;
        
        const allUsers = JSON.parse(localStorage.getItem('allUsers') || '{}');
        allUsers[userData.id] = userData;
        localStorage.setItem('allUsers', JSON.stringify(allUsers));
    }
    return userCode;
}

// Load user data from localStorage
function loadLocalData() {
    const savedData = localStorage.getItem('yzemanUserData');
    if (savedData) {
        try {
            const parsedData = JSON.parse(savedData);
            
            const numericFields = [
                'points', 'referrals', 'socialDollars', 
                'adCount', 'premiumAdCount', 'dailyReset',
                'multiplier', 'nextTierRefs'
            ];
            
            numericFields.forEach(field => {
                if (parsedData[field] !== undefined) {
                    parsedData[field] = Number(parsedData[field]);
                }
            });
            
            if (parsedData.completedTasks) {
                for (const task in parsedData.completedTasks) {
                    parsedData.completedTasks[task] = Number(parsedData.completedTasks[task]);
                }
            }
            
            if (parsedData.withdrawals) {
                parsedData.withdrawals = parsedData.withdrawals.map(wd => ({
                    ...wd,
                    date: new Date(wd.date)
                }));
            }
            
            Object.assign(userData, parsedData);
        } catch (e) {
            console.error('Error loading user data:', e);
            const wallet = userData.walletAddress;
            userData = {
                id: userData.id,
                points: 0,
                referrals: 0,
                tier: "Fresher",
                multiplier: 1,
                nextTierRefs: 50,
                referralCode: userData.referralCode || '',
                completedSocial: {
                    youtube1: false,
                    youtube2: false,
                    youtube3: false,
                    facebook: false,
                    instagram: false,
                    twitter: false,
                    telegram: false
                },
                completedTasks: {
                    website: 0,
                    youtubeWatch: 0,
                    adWatch: 0,
                    premiumAd: 0
                },
                socialDollars: 0,
                walletAddress: wallet || "",
                adCount: 0,
                premiumAdCount: 0,
                dailyReset: new Date().setHours(24, 0, 0, 0),
                usedBonusCodes: {},
                withdrawals: []
            };
        }
    }
    
    const allUsers = JSON.parse(localStorage.getItem('allUsers') || '{}');
    if (!allUsers[userData.id]) {
        allUsers[userData.id] = userData;
        localStorage.setItem('allUsers', JSON.stringify(allUsers));
    }
    
    updateUI();
}

// Save user data to localStorage
function saveUserData() {
    const allUsers = JSON.parse(localStorage.getItem('allUsers') || '{}');
    allUsers[userData.id] = userData;
    localStorage.setItem('allUsers', JSON.stringify(allUsers));
    
    localStorage.setItem('yzemanUserData', JSON.stringify(userData));
}

// Start the daily reset timer
function startResetTimer() {
    const updateTimer = () => {
        const now = new Date();
        const resetTime = new Date(userData.dailyReset);
        const diff = resetTime - now;
        
        if (diff <= 0) {
            userData.completedTasks.website = 0;
            userData.completedTasks.youtubeWatch = 0;
            userData.completedTasks.adWatch = 0;
            userData.completedTasks.premiumAd = 0;
            userData.adCount = 0;
            userData.premiumAdCount = 0;
            
            const nextMidnight = new Date();
            nextMidnight.setHours(24, 0, 0, 0);
            userData.dailyReset = nextMidnight.getTime();
            
            saveUserData();
            updateUI();
            showNotification("Daily tasks have been reset!");
        }
        
        const hours = Math.floor(diff / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);
        
        if (resetTimerElement) {
            resetTimerElement.textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
    };
    
    updateTimer();
    setInterval(updateTimer, 1000);
}

function canDoTaskToday(taskName) {
    const lastCompleted = userData.completedTasks[taskName];
    if (!lastCompleted) return true;
    
    const lastDate = new Date(lastCompleted);
    const today = new Date();
    
    return lastDate.getDate() !== today.getDate() || 
           lastDate.getMonth() !== today.getMonth() ||
           lastDate.getFullYear() !== today.getFullYear();
}

// Setup event listeners
function setupEventListeners() {
    document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            tab.classList.add('active');
            document.getElementById(`${tab.dataset.tab}Tab`).classList.add('active');
        });
    });
    
    document.getElementById('watchAdBtn').addEventListener('click', startAdWatch);
    document.getElementById('premiumAdBtn').addEventListener('click', startPremiumAd);
    document.getElementById('changeAdBtn').addEventListener('click', changePremiumAd);
    document.getElementById('referBtn').addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab')[1].classList.add('active');
        document.getElementById('referTab').classList.add('active');
    });
    
    document.getElementById('visitWebsiteBtn').addEventListener('click', startWebsiteTask);
    document.getElementById('watchYoutubeBtn').addEventListener('click', startYoutubeTask);
    
    document.getElementById('youtubeBtn1').addEventListener('click', () => completeSocialTask('youtube1', 'https://youtube.com/@yzeupdates'));
    document.getElementById('youtubeBtn2').addEventListener('click', () => completeSocialTask('youtube2', 'https://youtube.com/@codingappwithhtml'));
    document.getElementById('youtubeBtn3').addEventListener('click', () => completeSocialTask('youtube3', 'https://youtube.com/@yzemanhacker8831'));
    document.getElementById('facebookBtn').addEventListener('click', () => completeSocialTask('facebook', 'https://www.facebook.com/share/1ADZJ1DVyn/?mibextid=wwXIfr'));
    document.getElementById('instagramBtn').addEventListener('click', () => completeSocialTask('instagram', 'https://www.instagram.com/yzeupdates?igsh=MTR6dHdmODVhcDVzaw%3D%3D&utm_source=qr'));
    document.getElementById('twitterBtn').addEventListener('click', () => completeSocialTask('twitter', 'https://x.com/oisreal80231?s=21'));
    joinChannelBtn.addEventListener('click', () => completeSocialTask('telegram', 'https://t.me/YzemanEarnBotChannel'));
    
    document.getElementById('copyCodeBtn').addEventListener('click', copyReferralLink);
    withdrawBtn.addEventListener('click', startWithdrawal);
    closeIframe.addEventListener('click', () => {
        iframeContainer.style.display = 'none';
        timerElement.style.display = 'none';
    });
    
    submitWalletBtn.addEventListener('click', saveWalletAddress);
    redeemBonusBtn.addEventListener('click', redeemBonusCode);
}

// Copy the full referral link
function copyReferralLink() {
    const link = document.getElementById('referralLink').textContent;
    navigator.clipboard.writeText(link).then(() => {
        showNotification('Referral link copied to clipboard!');
    }).catch(err => {
        console.error('Failed to copy: ', err);
        showNotification('Failed to copy link', 'error');
    });
}

// Redeem bonus code
function redeemBonusCode() {
    const code = bonusCodeInput.value.trim().toUpperCase();
    
    if (!code) {
        showNotification('Please enter a bonus code', 'error');
        return;
    }
    
    const bonus = bonusCodes[code];
    
    if (!bonus) {
        showNotification('Invalid bonus code', 'error');
        return;
    }
    
    const today = new Date().toDateString();
    if (bonus.daily) {
        if (userData.usedBonusCodes[code] === today) {
            showNotification('This code has already been used today', 'error');
            return;
        }
    } else if (userData.usedBonusCodes[code]) {
        showNotification('This code has already been used', 'error');
        return;
    }
    
    let message = 'Bonus code applied! ';
    
    if (bonus.points > 0) {
        userData.points += bonus.points;
        message += `+${bonus.points.toLocaleString()} points `;
    }
    
    if (bonus.dollars > 0) {
        userData.socialDollars += bonus.dollars;
        message += `+$${bonus.dollars} `;
    }
    
    userData.usedBonusCodes[code] = bonus.daily ? today : true;
    saveUserData();
    updateUI();
    
    showNotification(message);
}

// Start watching an ad using SDK
function startAdWatch() {
    const currentTier = tiers.find(t => t.name === userData.tier);
    const reward = currentTier?.adReward || 70;
    const actualReward = Math.floor(Number(reward) * Number(userData.multiplier));
        
    adStatus.textContent = "Loading ad...";
    adLoading.style.display = 'flex';
    
    // Use SDK to show ad
    if (typeof show_9683863 === 'function') {
        show_9683863().then(() => {
            // User completed the ad
            userData.points += actualReward;
            userData.adCount++;
            userData.completedTasks.adWatch = Date.now();
            saveUserData();
            updateUI();
            showNotification(`+${actualReward.toLocaleString()} points earned!`);
        }).catch((error) => {
            showNotification('Ad not completed or failed to load', 'error');
        }).finally(() => {
            adLoading.style.display = 'none';
        });
    } else {
        // Fallback ad implementation
        showFallbackAd(actualReward);
    }
}

// Fallback ad implementation when SDK fails
function showFallbackAd(reward) {
    adStatus.textContent = "Loading fallback ad...";
    
    // Simulate ad loading
    setTimeout(() => {
        // Simulate ad completion after 5 seconds
        setTimeout(() => {
            userData.points += reward;
            userData.adCount++;
            userData.completedTasks.adWatch = Date.now();
            saveUserData();
            updateUI();
            adLoading.style.display = 'none';
            showNotification(`+${reward.toLocaleString()} points earned!`);
        }, 5000);
        
        // Show a simple ad simulation
        taskIframe.src = 'about:blank';
        iframeContainer.style.display = 'flex';
        timerElement.style.display = 'block';
        timerElement.textContent = "00:05";
        
        let seconds = 5;
        const timer = setInterval(() => {
            seconds--;
            timerElement.textContent = `00:0${seconds}`;
            
            if (seconds <= 0) {
                clearInterval(timer);
                iframeContainer.style.display = 'none';
                timerElement.style.display = 'none';
            }
        }, 1000);
    }, 1000);
}

// Start premium ad using SDK
function startPremiumAd() {
    if (userData.premiumAdCount >= 1) {
        showNotification('You can only complete one premium ad per day!');
        return;
    }
    
    adStatus.textContent = "Loading premium ad...";
    adLoading.style.display = 'flex';
    
    if (typeof show_9683863 === 'function') {
        show_9683863('pop').then(() => {
            const reward = 1000 * userData.multiplier;
            userData.points += reward;
            userData.premiumAdCount++;
            userData.completedTasks.premiumAd = Date.now();
            saveUserData();
            updateUI();
            showNotification(`Premium ad completed! +${reward.toLocaleString()} points`);
        }).catch((error) => {
            showNotification('Premium ad not completed or failed to load', 'error');
        }).finally(() => {
            adLoading.style.display = 'none';
        });
    } else {
        // Fallback premium ad implementation
        showFallbackPremiumAd(1000 * userData.multiplier);
    }
}

// Fallback premium ad implementation
function showFallbackPremiumAd(reward) {
    adStatus.textContent = "Loading premium fallback ad...";
    
    setTimeout(() => {
        setTimeout(() => {
            userData.points += reward;
            userData.premiumAdCount++;
            userData.completedTasks.premiumAd = Date.now();
            saveUserData();
            updateUI();
            adLoading.style.display = 'none';
            showNotification(`Premium ad completed! +${reward.toLocaleString()} points`);
        }, 20000); // 20 seconds for premium ad
        
        taskIframe.src = 'about:blank';
        iframeContainer.style.display = 'flex';
        timerElement.style.display = 'block';
        timerElement.textContent = "00:20";
        
        let seconds = 20;
        const timer = setInterval(() => {
            seconds--;
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
            
            if (seconds <= 0) {
                clearInterval(timer);
                iframeContainer.style.display = 'none';
                timerElement.style.display = 'none';
            }
        }, 1000);
    }, 1000);
}

// Change premium ad
function changePremiumAd() {
    currentPremiumAd = (currentPremiumAd + 1) % premiumAds.length;
    showNotification('Premium ad changed!');
}

// Update timer display
function updateTimer(seconds) {
    const minutes = Math.floor(seconds / 60);
    const remainingSeconds = seconds % 60;
    timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
}

// Start website visit task
function startWebsiteTask() {
    if (!canDoTaskToday('website')) {
        showNotification('You have already completed this task today!');
        return;
    }
    
    taskIframe.src = 'https://yzeupdates.lat/articles.html';
    iframeContainer.style.display = 'flex';
    timerElement.style.display = 'block';
    
    let timeSpent = 0;
    const requiredTime = 120;
    updateTimer(requiredTime);
    
    const timer = setInterval(() => {
        timeSpent++;
        const timeLeft = requiredTime - timeSpent;
        updateTimer(timeLeft);
        
        if (timeSpent >= requiredTime) {
            clearInterval(timer);
            iframeContainer.style.display = 'none';
            timerElement.style.display = 'none';
            
            const reward = 500 * userData.multiplier;
            userData.points += reward;
            userData.completedTasks.website = Date.now();
            saveUserData();
            updateUI();
            showNotification(`Website task completed! +${reward.toLocaleString()} points`);
        }
    }, 1000);
}

// Start YouTube watch task
function startYoutubeTask() {
    if (!canDoTaskToday('youtubeWatch')) {
        showNotification('You have already completed this task today!');
        return;
    }
    
    taskIframe.src = 'https://www.youtube.com/embed/FFiEFCCAM4c?autoplay=1';
    iframeContainer.style.display = 'flex';
    timerElement.style.display = 'block';
    
    let timeSpent = 0;
    const requiredTime = 5 * 60;
    updateTimer(requiredTime);
    
    const timer = setInterval(() => {
        timeSpent++;
        const timeLeft = requiredTime - timeSpent;
        updateTimer(timeLeft);
        
        if (iframeContainer.style.display === 'none') {
            clearInterval(timer);
            timerElement.style.display = 'none';
            return;
        }
        
        if (timeSpent >= requiredTime) {
            clearInterval(timer);
            iframeContainer.style.display = 'none';
            timerElement.style.display = 'none';
            
            const reward = 2000 * userData.multiplier;
            userData.points += reward;
            userData.completedTasks.youtubeWatch = Date.now();
            saveUserData();
            updateUI();
            showNotification(`YouTube task completed! +${reward.toLocaleString()} points`);
        }
    }, 1000);
}

// Complete social media follow task
function completeSocialTask(platform, url) {
    if (userData.completedSocial[platform]) {
        const platformName = platform.startsWith('youtube') ? 'YouTube' : 
                           platform === 'telegram' ? 'Telegram' : 
                           platform.charAt(0).toUpperCase() + platform.slice(1);
        
        if(platform === 'telegram') {
            window.open(url, '_blank');
        }
        
        showNotification(`You already followed us on ${platformName}!`);
        return;
    }
    
    window.open(url, '_blank');
    
    userData.completedSocial[platform] = true;
    userData.socialDollars += 50;
    saveUserData();
    updateUI();
    showNotification(`+$50 bonus! Thank you for following!`);
}

// Check for tier upgrade
function checkTierUpgrade() {
    const currentTierIndex = tiers.findIndex(t => t.name === userData.tier);
    if (currentTierIndex < tiers.length - 1) {
        const nextTier = tiers[currentTierIndex + 1];
        if (userData.referrals >= nextTier.refsRequired) {
            userData.tier = nextTier.name;
            userData.multiplier = nextTier.multiplier;
            userData.nextTierRefs = currentTierIndex < tiers.length - 2 ? 
                tiers[currentTierIndex + 2].refsRequired - userData.referrals : 0;
            
            saveUserData();
            updateUI();
            showNotification(`Congratulations! You've been upgraded to ${next极客
            } tier!`);
        }
    }
}

// Start withdrawal process
function startWithdrawal() {
    if (userData.walletAddress) {
        userData.withdrawals.push({
            amount: 1000,
            date: new Date(),
            status: 'pending'
        });
        
        userData.points = 0;
        userData.socialDollars = 0;
        
        saveUserData();
        updateUI();
        
        if (tg) {
            tg.showPopup({
                title: 'Withdrawal Requested',
                message: 'Admin will contact you via Telegram to complete your withdrawal.',
                buttons: [{ type: 'ok' }]
            });
        }
        
        showNotification('Withdrawal requested! Admin will contact you soon.');
    } else {
        showNotification('Please enter your USDT wallet address first', 'error');
    }
}

// Save wallet address
function saveWalletAddress() {
    const address = walletAddressInput.value.trim();
    if (address) {
        userData.walletAddress = address;
        saveUserData();
        updateUI();
        showNotification('Wallet address saved successfully!');
    } else {
        showNotification('Please enter a valid wallet address', 'error');
    }
}

// Update UI with current data
function updateUI() {
    pointsElement.textContent = `${userData.points.toLocaleString()} pts`;
    const usdValue = userData.points / 100000;
    pointsUSDElement.textContent = usdValue.toFixed(2);
    
    const totalBalance = usdValue + userData.socialDollars;
    const progressPercent = Math.min(100, (totalBalance / 1000) * 100);
    progressBar.style.width = `${progressPercent}%`;
    progressAmount.textContent = totalBalance.toFixed(2);
    withdrawProgress.textContent = totalBalance.toFixed(2);
    withdrawBar.style.width = `${progressPercent}%`;
    
    const currentTier = tiers.find(t => t.name === userData.tier);
    userTierElement.textContent = userData.tier;
    referralCountElement.textContent = `${userData.referrals} referral${userData.referrals !== 1 ? 's' : ''}`;
    currentTierElement.textContent = userData.tier;
    tierMultiplierElement.textContent = `${userData.multiplier}x`;
    nextTierRefElement.textContent = userData.next极客
    referralRewardElement.textContent = currentTier?.referralReward || 1000;
    
    currentReferralRewardElement.textContent = currentTier?.referralReward || 1000;
    
    const userCode = generateUserReferralCode();
    referralCodeElement.textContent = userCode;
    referralLinkElement.textContent = `https://t.me/YzemanBot?start=ref-${userCode}`;
    
    currentRefCountElement.textContent = userData.referrals;
    currentRefsElement.textContent = userData.referrals;
    
    const nextTier = tiers[tiers.findIndex(t => t.name === userData.tier) + 1];
    if (nextTier) {
        nextTierReqElement.textContent = nextTier.refsRequired;
        const tierProgress = (userData.referrals / nextTier.refsRequired) * 100;
        document.getElementById('tierProgressBar').style.width = `${Math.min(100, tierProgress)}%`;
    }
    
    withdrawBtn.disabled = totalBalance < 1000 || !userData.walletAddress;
    updateTaskButtons();
    
    if (userData.walletAddress) {
        walletAddressInput.value = userData.walletAddress;
    }
    
    adCounterElement.textContent = `${userData.adCount}/∞`;
    premiumAdCounterElement.textContent = `${userData.premiumAdCount}/1`;
    
    renderWithdrawalHistory();
}

// Render withdrawal history list
function renderWithdrawalHistory() {
    const container = document.getElementById('withdrawalHistoryList');
    if (!container) return;
    
    if (userData.withdrawals.length === 0) {
        container.innerHTML = '<div style="text-align: center; color: var(--gray); padding: 20px;">No withdrawal history</div>';
        return;
    }
    
    const sortedWithdrawals = [...userData.withdrawals].sort((a, b) => b.date - a.date);
    
    container.innerHTML = sortedWithdrawals.map(wd => `
        <div class="history-item">
            <div class="history-amount">$${wd.amount.toFixed(2)}</div>
            <div class="history-date">${wd.date.toLocaleDateString()}</div>
            <div class="history-status status-${wd.status}">${wd.status}</div>
        </div>
    `).join('');
}

// Generate a referral code
function generateReferralCode() {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    let code = '';
    for (let i = 0; i < 6; i++) {
        code += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return code;
}

// Update task buttons based on completion
function updateTaskButtons() {
    document.getElementById('visitWebsiteBtn').disabled = !canDoTaskToday('website');
    document.getElementById('watchYoutubeBtn').disabled = !canDoTaskToday('youtubeWatch');
    document.getElementById('watchAdBtn').disabled = false;
    
    document.getElementById('premiumAdBtn').disabled = userData.premiumAdCount >= 1;
    
    document.getElementById('youtubeBtn1').disabled = userData.completedSocial.youtube1;
    document.getElementById('youtubeBtn2').disabled = userData.completedSocial.youtube2;
    document.getElementById('youtubeBtn3').disabled = userData.completedSocial.youtube3;
    document.getElementById('facebookBtn').disabled = userData.completedSocial.facebook;
    document.getElementById('instagramBtn').disabled = userData.completedSocial.instagram;
    document.getElementById('twitterBtn').disabled = userData.completedSocial.twitter;
    joinChannelBtn.disabled = userData.completedSocial.telegram;
}

// Show notification
function showNotification(message, type = 'success') {
    notification.textContent = message;
    notification.style.background = type === 'error' ? 'var(--danger)' : 'var(--success)';
    notification.style.display = 'block';
    
    setTimeout(() => {
        notification.style.display = 'none';
    }, 3000);
}

// Initialize app when ready
document.addEventListener('DOMContentLoaded', () => {
    if (tg) {
        tg.ready();
    }
    initApp();
});
</script><script>
// Initialize Telegram Web App
const tg = window.Telegram?.WebApp;

// DOM Elements
const pointsElement = document.getElementById('points');
const pointsUSDElement = document.getElementById('pointsUSD');
const progressBar = document.getElementById('progressBar');
const progressAmount = document.getElementById('progressAmount');
const userTierElement = document.getElementById('userTier');
const referralCountElement = document.getElementById('referralCount');
const currentTierElement = document.getElementById('currentTier');
const tierMultiplierElement = document.getElementById('tierMultiplier');
const nextTierRefElement = document.getElementById('nextTierRef');
const referralCodeElement = document.getElementById('userCode');
const referralLinkElement = document.getElementById('referralLink');
const withdrawBtn = document.getElementById('withdrawBtn');
const withdrawProgress = document.getElementById('withdrawProgress');
const withdrawBar = document.getElementById('withdrawBar');
const notification = document.getElementById('notification');
const iframeContainer = document.getElementById('iframeContainer');
const taskIframe = document.getElementById('taskIframe');
const closeIframe = document.getElementById('closeIframe');
const timerElement = document.getElementById('timer');
const walletAddressInput = document.getElementById('walletAddress');
const submitWalletBtn = document.getElementById('submitWalletBtn');
const resetTimerElement = document.getElementById('resetTimer');
const adCounterElement = document.getElementById('adCounter');
const premiumAdCounterElement = document.getElementById('premiumAdCounter');
const referralRewardElement = document.getElementById('referralReward');
const adLoading = document.getElementById('adLoading');
const adStatus = document.getElementById('adStatus');
const userNameElement = document.getElementById('userName');
const userIdElement = document.getElementById('userId');
const userAvatarElement = document.getElementById('userAvatar');
const joinChannelBtn = document.getElementById('joinChannelBtn');
const currentRefsElement = document.getElementById('currentRefs');
const nextTierReqElement = document.getElementById('nextTierReq');
const currentRefCountElement = document.getElementById('currentRefCount');
const currentReferralRewardElement = document.getElementById('currentReferralReward');
const redeemBonusBtn = document.getElementById('redeemBonusBtn');
const bonusCodeInput = document.getElementById('bonusCodeInput');

// User data
let userData = {
    id: '',
    points: 0,
    referrals: 0,
    tier: "Fresher",
    multiplier: 1,
    nextTierRefs: 50,
    referralCode: '',
    completedSocial: {
        youtube1: false,
        youtube2: false,
        youtube3: false,
        facebook: false,
        instagram: false,
        twitter: false,
        telegram: false
    },
    completedTasks: {
        website: 0,
        youtubeWatch: 0,
        adWatch: 0,
        premiumAd: 0
    },
    socialDollars: 0,
    walletAddress: "",
    adCount: 0,
    premiumAdCount: 0,
    dailyReset: new Date().setHours(24, 0, 0, 0),
    usedBonusCodes: {},
    withdrawals: []
};

// Tier system with higher requirements
const tiers = [
    { name: "Fresher", refsRequired: 0, multiplier: 1, adReward: 51, referralReward: 1000 },
    { name: "Brute", refsRequired: 50, multiplier: 1.2, adReward: 74, referralReward: 1500 },
    { name: "Silver", refsRequired: 150, multiplier: 1.5, adReward: 105, referralReward: 2000 },
    { name: "Gold", refsRequired: 300, multiplier: 2, adReward: 140, referralReward: 3000 },
    { name: "Platinum", refsRequired: 500, multiplier: 3, adReward: 210, referralReward: 5000 }
];

// Initialize app
function initApp() {
    if (tg) {
        tg.expand();
        tg.enableClosingConfirmation();
        
        // Set up user profile
        const user = tg.initDataUnsafe.user;
        if (user) {
            userData.id = user.id.toString();
            userNameElement.textContent = `${user.first_name} ${user.last_name || ''}`.trim();
            userIdElement.textContent = `ID: ${user.id}`;
            
            if (user.photo_url) {
                userAvatarElement.src = user.photo_url;
            } else {
                userAvatarElement.src = 'https://via.placeholder.com/50';
            }
        } else {
            userData.id = Date.now().toString();
            userNameElement.textContent = 'Telegram User';
            userIdElement.textContent = `ID: ${userData.id}`;
            userAvatarElement.src = 'https://via.placeholder.com/50';
        }
    } else {
        userData.id = Date.now().toString();
        userNameElement.textContent = 'Test User';
        userIdElement.textContent = `ID: ${userData.id}`;
        userAvatarElement.src = 'https://via.placeholder.com/50';
    }
    
    loadLocalData();
    handleReferral();
    setupEventListeners();
    startResetTimer();
}

function handleReferral() {
    let refCode = '';
    
    if (window.Telegram && Telegram.WebApp) {
        const startParam = Telegram.WebApp.startParam;
        if (startParam && startParam.startsWith('ref-')) {
            refCode = startParam.split('ref-')[1];
        }
    }
    
    if (!refCode) {
        const urlParams = new URLSearchParams(window.location.search);
        refCode = urlParams.get('ref');
    }
    
    if (refCode) {
        localStorage.setItem('referralCode', refCode);
        showNotification('Referral code applied!');
        processReferral(refCode);
    }
}

function processReferral(refCode) {
    const userCode = generateUserReferralCode();
    if (refCode && refCode !== userCode) {
        const allUsers = JSON.parse(localStorage.getItem('allUsers') || '{}');
        const referrerId = Object.keys(allUsers).find(id => 
            allUsers[id].referralCode === refCode
        );
        
        if (referrerId) {
            const referrer = allUsers[referrerId];
            const currentTier = tiers.find(t => t.name === referrer.tier);
            const reward = currentTier?.referralReward || 1000;
            
            referrer.referrals += 1;
            referrer.points += reward;
            
            const tierIndex = tiers.findIndex(t => t.name === referrer.tier);
            if (tierIndex < tiers.length - 1 && referrer.referrals >= tiers[tierIndex + 1].refsRequired) {
                referrer.tier = tiers[tierIndex + 1].name;
                referrer.multiplier = tiers[tierIndex + 1].multiplier;
            }
            
            allUsers[referrerId] = referrer;
            localStorage.setItem('allUsers', JSON.stringify(allUsers));
            
            userData.points += 500;
            saveUserData();
            showNotification('Referral applied! +500 bonus points');
        }
    }
    
    localStorage.removeItem('referralCode');
}

function generateUserReferralCode() {
    let userCode = localStorage.getItem('userReferralCode');
    if (!userCode) {
        userCode = generateReferralCode();
        localStorage.setItem('userReferralCode', userCode);
        userData.referralCode = userCode;
        
        const allUsers = JSON.parse(localStorage.getItem('allUsers') || '{}');
        allUsers[userData.id] = userData;
        localStorage.setItem('allUsers', JSON.stringify(allUsers));
    }
    return userCode;
}

// Load user data from localStorage
function loadLocalData() {
    const savedData = localStorage.getItem('yzemanUserData');
    if (savedData) {
        try {
            const parsedData = JSON.parse(savedData);
            
            const numericFields = [
                'points', 'referrals', 'socialDollars', 
                'adCount', 'premiumAdCount', 'dailyReset',
                'multiplier', 'nextTierRefs'
            ];
            
            numericFields.forEach(field => {
                if (parsedData[field] !== undefined) {
                    parsedData[field] = Number(parsedData[field]);
                }
            });
            
            if (parsedData.completedTasks) {
                for (const task in parsedData.completedTasks) {
                    parsedData.completedTasks[task] = Number(parsedData.completedTasks[task]);
                }
            }
            
            if (parsedData.withdrawals) {
                parsedData.withdrawals = parsedData.withdrawals.map(wd => ({
                    ...wd,
                    date: new Date(wd.date)
                }));
            }
            
            Object.assign(userData, parsedData);
        } catch (e) {
            console.error('Error loading user data:', e);
            const wallet = userData.walletAddress;
            userData = {
                id: userData.id,
                points: 0,
                referrals: 0,
                tier: "Fresher",
                multiplier: 1,
                nextTierRefs: 50,
                referralCode: userData.referralCode || '',
                completedSocial: {
                    youtube1: false,
                    youtube2: false,
                    youtube3: false,
                    facebook: false,
                    instagram: false,
                    twitter: false,
                    telegram: false
                },
                completedTasks: {
                    website: 0,
                    youtubeWatch: 0,
                    adWatch: 0,
                    premiumAd: 0
                },
                socialDollars: 0,
                walletAddress: wallet || "",
                adCount: 0,
                premiumAdCount: 0,
                dailyReset: new Date().setHours(24, 0, 0, 0),
                usedBonusCodes: {},
                withdrawals: []
            };
        }
    }
    
    const allUsers = JSON.parse(localStorage.getItem('allUsers') || '{}');
    if (!allUsers[userData.id]) {
        allUsers[userData.id] = userData;
        localStorage.setItem('allUsers', JSON.stringify(allUsers));
    }
    
    updateUI();
}

// Save user data to localStorage
function saveUserData() {
    const allUsers = JSON.parse(localStorage.getItem('allUsers') || '{}');
    allUsers[userData.id] = userData;
    localStorage.setItem('allUsers', JSON.stringify(allUsers));
    
    localStorage.setItem('yzemanUserData', JSON.stringify(userData));
}

// Start the daily reset timer
function startResetTimer() {
    const updateTimer = () => {
        const now = new Date();
        const resetTime = new Date(userData.dailyReset);
        const diff = resetTime - now;
        
        if (diff <= 0) {
            userData.completedTasks.website = 0;
            userData.completedTasks.youtubeWatch = 0;
            userData.completedTasks.adWatch = 0;
            userData.completedTasks.premiumAd = 0;
            userData.adCount = 0;
            userData.premiumAdCount = 0;
            
            const nextMidnight = new Date();
            nextMidnight.setHours(24, 0, 0, 0);
            userData.dailyReset = nextMidnight.getTime();
            
            saveUserData();
            updateUI();
            showNotification("Daily tasks have been reset!");
        }
        
        const hours = Math.floor(diff / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);
        
        if (resetTimerElement) {
            resetTimerElement.textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
    };
    
    updateTimer();
    setInterval(updateTimer, 1000);
}

function canDoTaskToday(taskName) {
    const lastCompleted = userData.completedTasks[taskName];
    if (!lastCompleted) return true;
    
    const lastDate = new Date(lastCompleted);
    const today = new Date();
    
    return lastDate.getDate() !== today.getDate() || 
           lastDate.getMonth() !== today.getMonth() ||
           lastDate.getFullYear() !== today.getFullYear();
}

// Setup event listeners
function setupEventListeners() {
    document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            tab.classList.add('active');
            document.getElementById(`${tab.dataset.tab}Tab`).classList.add('active');
        });
    });
    
    document.getElementById('watchAdBtn').addEventListener('click', startAdWatch);
    document.getElementById('premiumAdBtn').addEventListener('click', startPremiumAd);
    document.getElementById('changeAdBtn').addEventListener('click', changePremiumAd);
    document.getElementById('referBtn').addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab')[1].classList.add('active');
        document.getElementById('referTab').classList.add('active');
    });
    
    document.getElementById('visitWebsiteBtn').addEventListener('click', startWebsiteTask);
    document.getElementById('watchYoutubeBtn').addEventListener('click', startYoutubeTask);
    
    document.getElementById('youtubeBtn1').addEventListener('click', () => completeSocialTask('youtube1', 'https://youtube.com/@yzeupdates'));
    document.getElementById('youtubeBtn2').addEventListener('click', () => completeSocialTask('youtube2', 'https://youtube.com/@codingappwithhtml'));
    document.getElementById('youtubeBtn3').addEventListener('click', () => completeSocialTask('youtube3', 'https://youtube.com/@yzemanhacker8831'));
    document.getElementById('facebookBtn').addEventListener('click', () => completeSocialTask('facebook', 'https://www.facebook.com/share/1ADZJ1DVyn/?mibextid=wwXIfr'));
    document.getElementById('instagramBtn').addEventListener('click', () => completeSocialTask('instagram', 'https://www.instagram.com/yzeupdates?igsh=MTR6dHdmODVhcDVzaw%3D%3D&utm_source=qr'));
    document.getElementById('twitterBtn').addEventListener('click', () => completeSocialTask('twitter', 'https://x.com/oisreal80231?s=21'));
    joinChannelBtn.addEventListener('click', () => completeSocialTask('telegram', 'https://t.me/YzemanEarnBotChannel'));
    
    document.getElementById('copyCodeBtn').addEventListener('click', copyReferralLink);
    withdrawBtn.addEventListener('click', startWithdrawal);
    closeIframe.addEventListener('click', () => {
        iframeContainer.style.display = 'none';
        timerElement.style.display = 'none';
    });
    
    submitWalletBtn.addEventListener('click', saveWalletAddress);
    redeemBonusBtn.addEventListener('click', redeemBonusCode);
}

// Copy the full referral link
function copyReferralLink() {
    const link = document.getElementById('referralLink').textContent;
    navigator.clipboard.writeText(link).then(() => {
        showNotification('Referral link copied to clipboard!');
    }).catch(err => {
        console.error('Failed to copy: ', err);
        showNotification('Failed to copy link', 'error');
    });
}

// Redeem bonus code
function redeemBonusCode() {
    const code = bonusCodeInput.value.trim().toUpperCase();
    
    if (!code) {
        showNotification('Please enter a bonus code', 'error');
        return;
    }
    
    const bonus = bonusCodes[code];
    
    if (!bonus) {
        showNotification('Invalid bonus code', 'error');
        return;
    }
    
    const today = new Date().toDateString();
    if (bonus.daily) {
        if (userData.usedBonusCodes[code] === today) {
            showNotification('This code has already been used today', 'error');
            return;
        }
    } else if (userData.usedBonusCodes[code]) {
        showNotification('This code has already been used', 'error');
        return;
    }
    
    let message = 'Bonus code applied! ';
    
    if (bonus.points > 0) {
        userData.points += bonus.points;
        message += `+${bonus.points.toLocaleString()} points `;
    }
    
    if (bonus.dollars > 0) {
        userData.socialDollars += bonus.dollars;
        message += `+$${bonus.dollars} `;
    }
    
    userData.usedBonusCodes[code] = bonus.daily ? today : true;
    saveUserData();
    updateUI();
    
    showNotification(message);
}

// Start watching an ad using SDK
function startAdWatch() {
    const currentTier = tiers.find(t => t.name === userData.tier);
    const reward = currentTier?.adReward || 70;
    const actualReward = Math.floor(Number(reward) * Number(userData.multiplier));
        
    adStatus.textContent = "Loading ad...";
    adLoading.style.display = 'flex';
    
    // Use SDK to show ad
    if (typeof show_9683863 === 'function') {
        show_9683863().then(() => {
            // User completed the ad
            userData.points += actualReward;
            userData.adCount++;
            userData.completedTasks.adWatch = Date.now();
            saveUserData();
            updateUI();
            showNotification(`+${actualReward.toLocaleString()} points earned!`);
        }).catch((error) => {
            showNotification('Ad not completed or failed to load', 'error');
        }).finally(() => {
            adLoading.style.display = 'none';
        });
    } else {
        // Fallback ad implementation
        showFallbackAd(actualReward);
    }
}

// Fallback ad implementation when SDK fails
function showFallbackAd(reward) {
    adStatus.textContent = "Loading fallback ad...";
    
    // Simulate ad loading
    setTimeout(() => {
        // Simulate ad completion after 5 seconds
        setTimeout(() => {
            userData.points += reward;
            userData.adCount++;
            userData.completedTasks.adWatch = Date.now();
            saveUserData();
            updateUI();
            adLoading.style.display = 'none';
            showNotification(`+${reward.toLocaleString()} points earned!`);
        }, 5000);
        
        // Show a simple ad simulation
        taskIframe.src = 'about:blank';
        iframeContainer.style.display = 'flex';
        timerElement.style.display = 'block';
        timerElement.textContent = "00:05";
        
        let seconds = 5;
        const timer = setInterval(() => {
            seconds--;
            timerElement.textContent = `00:0${seconds}`;
            
            if (seconds <= 0) {
                clearInterval(timer);
                iframeContainer.style.display = 'none';
                timerElement.style.display = 'none';
            }
        }, 1000);
    }, 1000);
}

// Start premium ad using SDK
function startPremiumAd() {
    if (userData.premiumAdCount >= 1) {
        showNotification('You can only complete one premium ad per day!');
        return;
    }
    
    adStatus.textContent = "Loading premium ad...";
    adLoading.style.display = 'flex';
    
    if (typeof show_9683863 === 'function') {
        show_9683863('pop').then(() => {
            const reward = 1000 * userData.multiplier;
            userData.points += reward;
            userData.premiumAdCount++;
            userData.completedTasks.premiumAd = Date.now();
            saveUserData();
            updateUI();
            showNotification(`Premium ad completed! +${reward.toLocaleString()} points`);
        }).catch((error) => {
            showNotification('Premium ad not completed or failed to load', 'error');
        }).finally(() => {
            adLoading.style.display = 'none';
        });
    } else {
        // Fallback premium ad implementation
        showFallbackPremiumAd(1000 * userData.multiplier);
    }
}

// Fallback premium ad implementation
function showFallbackPremiumAd(reward) {
    adStatus.textContent = "Loading premium fallback ad...";
    
    setTimeout(() => {
        setTimeout(() => {
            userData.points += reward;
            userData.premiumAdCount++;
            userData.completedTasks.premiumAd = Date.now();
            saveUserData();
            updateUI();
            adLoading.style.display = 'none';
            showNotification(`Premium ad completed! +${reward.toLocaleString()} points`);
        }, 20000); // 20 seconds for premium ad
        
        taskIframe.src = 'about:blank';
        iframeContainer.style.display = 'flex';
        timerElement.style.display = 'block';
        timerElement.textContent = "00:20";
        
        let seconds = 20;
        const timer = setInterval(() => {
            seconds--;
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
            
            if (seconds <= 0) {
                clearInterval(timer);
                iframeContainer.style.display = 'none';
                timerElement.style.display = 'none';
            }
        }, 1000);
    }, 1000);
}

// Change premium ad
function changePremiumAd() {
    currentPremiumAd = (currentPremiumAd + 1) % premiumAds.length;
    showNotification('Premium ad changed!');
}

// Update timer display
function updateTimer(seconds) {
    const minutes = Math.floor(seconds / 60);
    const remainingSeconds = seconds % 60;
    timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
}

// Start website visit task
function startWebsiteTask() {
    if (!canDoTaskToday('website')) {
        showNotification('You have already completed this task today!');
        return;
    }
    
    taskIframe.src = 'https://yzeupdates.lat/articles.html';
    iframeContainer.style.display = 'flex';
    timerElement.style.display = 'block';
    
    let timeSpent = 0;
    const requiredTime = 120;
    updateTimer(requiredTime);
    
    const timer = setInterval(() => {
        timeSpent++;
        const timeLeft = requiredTime - timeSpent;
        updateTimer(timeLeft);
        
        if (timeSpent >= requiredTime) {
            clearInterval(timer);
            iframeContainer.style.display = 'none';
            timerElement.style.display = 'none';
            
            const reward = 500 * userData.multiplier;
            userData.points += reward;
            userData.completedTasks.website = Date.now();
            saveUserData();
            updateUI();
            showNotification(`Website task completed! +${reward.toLocaleString()} points`);
        }
    }, 1000);
}

// Start YouTube watch task
function startYoutubeTask() {
    if (!canDoTaskToday('youtubeWatch')) {
        showNotification('You have already completed this task today!');
        return;
    }
    
    taskIframe.src = 'https://www.youtube.com/embed/FFiEFCCAM4c?autoplay=1';
    iframeContainer.style.display = 'flex';
    timerElement.style.display = 'block';
    
    let timeSpent = 0;
    const requiredTime = 5 * 60;
    updateTimer(requiredTime);
    
    const timer = setInterval(() => {
        timeSpent++;
        const timeLeft = requiredTime - timeSpent;
        updateTimer(timeLeft);
        
        if (iframeContainer.style.display === 'none') {
            clearInterval(timer);
            timerElement.style.display = 'none';
            return;
        }
        
        if (timeSpent >= requiredTime) {
            clearInterval(timer);
            iframeContainer.style.display = 'none';
            timerElement.style.display = 'none';
            
            const reward = 2000 * userData.multiplier;
            userData.points += reward;
            userData.completedTasks.youtubeWatch = Date.now();
            saveUserData();
            updateUI();
            showNotification(`YouTube task completed! +${reward.toLocaleString()} points`);
        }
    }, 1000);
}

// Complete social media follow task
function completeSocialTask(platform, url) {
    if (userData.completedSocial[platform]) {
        const platformName = platform.startsWith('youtube') ? 'YouTube' : 
                           platform === 'telegram' ? 'Telegram' : 
                           platform.charAt(0).toUpperCase() + platform.slice(1);
        
        if(platform === 'telegram') {
            window.open(url, '_blank');
        }
        
        showNotification(`You already followed us on ${platformName}!`);
        return;
    }
    
    window.open(url, '_blank');
    
    userData.completedSocial[platform] = true;
    userData.socialDollars += 50;
    saveUserData();
    updateUI();
    showNotification(`+$50 bonus! Thank you for following!`);
}

// Check for tier upgrade
function checkTierUpgrade() {
    const currentTierIndex = tiers.findIndex(t => t.name === userData.tier);
    if (currentTierIndex < tiers.length - 1) {
        const nextTier = tiers[currentTierIndex + 1];
        if (userData.referrals >= nextTier.refsRequired) {
            userData.tier = nextTier.name;
            userData.multiplier = nextTier.multiplier;
            userData.nextTierRefs = currentTierIndex < tiers.length - 2 ? 
                tiers[currentTierIndex + 2].refsRequired - userData.referrals : 0;
            
            saveUserData();
            updateUI();
            showNotification(`Congratulations! You've been upgraded to ${next极客
            } tier!`);
        }
    }
}

// Start withdrawal process
function startWithdrawal() {
    if (userData.walletAddress) {
        userData.withdrawals.push({
            amount: 1000,
            date: new Date(),
            status: 'pending'
        });
        
        userData.points = 0;
        userData.socialDollars = 0;
        
        saveUserData();
        updateUI();
        
        if (tg) {
            tg.showPopup({
                title: 'Withdrawal Requested',
                message: 'Admin will contact you via Telegram to complete your withdrawal.',
                buttons: [{ type: 'ok' }]
            });
        }
        
        showNotification('Withdrawal requested! Admin will contact you soon.');
    } else {
        showNotification('Please enter your USDT wallet address first', 'error');
    }
}

// Save wallet address
function saveWalletAddress() {
    const address = walletAddressInput.value.trim();
    if (address) {
        userData.walletAddress = address;
        saveUserData();
        updateUI();
        showNotification('Wallet address saved successfully!');
    } else {
        showNotification('Please enter a valid wallet address', 'error');
    }
}

// Update UI with current data
function updateUI() {
    pointsElement.textContent = `${userData.points.toLocaleString()} pts`;
    const usdValue = userData.points / 100000;
    pointsUSDElement.textContent = usdValue.toFixed(2);
    
    const totalBalance = usdValue + userData.socialDollars;
    const progressPercent = Math.min(100, (totalBalance / 1000) * 100);
    progressBar.style.width = `${progressPercent}%`;
    progressAmount.textContent = totalBalance.toFixed(2);
    withdrawProgress.textContent = totalBalance.toFixed(2);
    withdrawBar.style.width = `${progressPercent}%`;
    
    const currentTier = tiers.find(t => t.name === userData.tier);
    userTierElement.textContent = userData.tier;
    referralCountElement.textContent = `${userData.referrals} referral${userData.referrals !== 1 ? 's' : ''}`;
    currentTierElement.textContent = userData.tier;
    tierMultiplierElement.textContent = `${userData.multiplier}x`;
    nextTierRefElement.textContent = userData.next极客
    referralRewardElement.textContent = currentTier?.referralReward || 1000;
    
    currentReferralRewardElement.textContent = currentTier?.referralReward || 1000;
    
    const userCode = generateUserReferralCode();
    referralCodeElement.textContent = userCode;
    referralLinkElement.textContent = `https://t.me/YzemanBot?start=ref-${userCode}`;
    
    currentRefCountElement.textContent = userData.referrals;
    currentRefsElement.textContent = userData.referrals;
    
    const nextTier = tiers[tiers.findIndex(t => t.name === userData.tier) + 1];
    if (nextTier) {
        nextTierReqElement.textContent = nextTier.refsRequired;
        const tierProgress = (userData.referrals / nextTier.refsRequired) * 100;
        document.getElementById('tierProgressBar').style.width = `${Math.min(100, tierProgress)}%`;
    }
    
    withdrawBtn.disabled = totalBalance < 1000 || !userData.walletAddress;
    updateTaskButtons();
    
    if (userData.walletAddress) {
        walletAddressInput.value = userData.walletAddress;
    }
    
    adCounterElement.textContent = `${userData.adCount}/∞`;
    premiumAdCounterElement.textContent = `${userData.premiumAdCount}/1`;
    
    renderWithdrawalHistory();
}

// Render withdrawal history list
function renderWithdrawalHistory() {
    const container = document.getElementById('withdrawalHistoryList');
    if (!container) return;
    
    if (userData.withdrawals.length === 0) {
        container.innerHTML = '<div style="text-align: center; color: var(--gray); padding: 20px;">No withdrawal history</div>';
        return;
    }
    
    const sortedWithdrawals = [...userData.withdrawals].sort((a, b) => b.date - a.date);
    
    container.innerHTML = sortedWithdrawals.map(wd => `
        <div class="history-item">
            <div class="history-amount">$${wd.amount.toFixed(2)}</div>
            <div class="history-date">${wd.date.toLocaleDateString()}</div>
            <div class="history-status status-${wd.status}">${wd.status}</div>
        </div>
    `).join('');
}

// Generate a referral code
function generateReferralCode() {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    let code = '';
    for (let i = 0; i < 6; i++) {
        code += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return code;
}

// Update task buttons based on completion
function updateTaskButtons() {
    document.getElementById('visitWebsiteBtn').disabled = !canDoTaskToday('website');
    document.getElementById('watchYoutubeBtn').disabled = !canDoTaskToday('youtubeWatch');
    document.getElementById('watchAdBtn').disabled = false;
    
    document.getElementById('premiumAdBtn').disabled = userData.premiumAdCount >= 1;
    
    document.getElementById('youtubeBtn1').disabled = userData.completedSocial.youtube1;
    document.getElementById('youtubeBtn2').disabled = userData.completedSocial.youtube2;
    document.getElementById('youtubeBtn3').disabled = userData.completedSocial.youtube3;
    document.getElementById('facebookBtn').disabled = userData.completedSocial.facebook;
    document.getElementById('instagramBtn').disabled = userData.completedSocial.instagram;
    document.getElementById('twitterBtn').disabled = userData.completedSocial.twitter;
    joinChannelBtn.disabled = userData.completedSocial.telegram;
}

// Show notification
function showNotification(message, type = 'success') {
    notification.textContent = message;
    notification.style.background = type === 'error' ? 'var(--danger)' : 'var(--success)';
    notification.style.display = 'block';
    
    setTimeout(() => {
        notification.style.display = 'none';
    }, 3000);
}

// Initialize app when ready
document.addEventListener('DOMContentLoaded', () => {
    if (tg) {
        tg.ready();
    }
    initApp();
});
</script>
</body>
</html>